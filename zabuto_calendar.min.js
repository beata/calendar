if(typeof jQuery=="undefined"){throw new Error("jQuery is not loaded")}$.fn.zabuto_calendar=function(b){var c=$.extend({},$.fn.zabuto_calendar_defaults(),b);var a=$.fn.zabuto_calendar_language(c.language);c=$.extend({},c,a);this.each(function(){var p={};var j=$(this);j.attr("id","zabuto_calendar_"+Math.floor(Math.random()*99999).toString(36));j.data("api",p);j.data("initYear",c.year);j.data("initMonth",c.month);j.data("monthLabels",c.month_labels);j.data("weekStartsOn",c.weekstartson);j.data("navIcons",c.nav_icon);j.data("dowLabels",c.dow_labels);j.data("showToday",c.today);j.data("showDays",c.show_days);j.data("showPrevious",c.show_previous);j.data("showNext",c.show_next);j.data("cellBorder",c.cell_border);j.data("jsonData",c.data);j.data("ajaxSettings",c.ajax);j.data("legendList",c.legend);j.data("actionFunction",c.action);j.data("actionNavFunction",c.action_nav);l();function l(){var z=parseInt(j.data("initYear"));var C=parseInt(j.data("initMonth"))-1;var D=new Date(z,C,1,0,0,0,0);j.data("initDate",D);var E=(j.data("cellBorder")===true)?" table-bordered":"";$tableObj=$('<table class="table'+E+'"></table>');$tableObj=x(j,$tableObj,D.getFullYear(),D.getMonth());$legendObj=g(j);var A=$('<div class="zabuto_calendar" id="'+j.attr("id")+'"></div>');A.append($tableObj);A.append($legendObj);j.append(A);var B=j.data("jsonData");if(false!==B){s(j,D.getFullYear(),D.getMonth())}}function x(B,D,A,C){var z=new Date(A,C,1,0,0,0,0);B.data("currDate",z);D.empty();D=t(B,D,A,C);D=e(B,D);D=r(B,D,A,C);s(B,A,C);return D}function g(B){var z=$('<div class="legend" id="'+B.attr("id")+'_legend"></div>');var A=B.data("legendList");if(typeof(A)=="object"&&A.length>0){$(A).each(function(F,H){if(typeof(H)=="object"){if("type" in H){var G="";if("label" in H){G=H.label}switch(H.type){case"text":if(G!==""){var E="";if("badge" in H){if(typeof(H.classname)==="undefined"){var I="badge-event"}else{var I=H.classname}E='<span class="badge '+I+'">'+H.badge+"</span> "}z.append('<span class="legend-'+H.type+'">'+E+G+"</span>")}break;case"block":if(G!==""){G="<span>"+G+"</span>"}if(typeof(H.classname)==="undefined"){var D="event"}else{var D="event-styled "+H.classname}z.append('<span class="legend-'+H.type+'"><ul class="legend"><li class="'+D+'"></li></u>'+G+"</span>");break;case"list":if("list" in H&&typeof(H.list)=="object"&&H.list.length>0){var C=$('<ul class="legend"></u>');$(H.list).each(function(K,J){C.append('<li class="'+J+'"></li>')});z.append(C)}break;case"spacer":z.append('<span class="legend-'+H.type+'"> </span>');break}}}})}return z}function t(O,C,L,J){var K=O.data("navIcons");var H=$('<span><span class="glyphicon glyphicon-chevron-left"></span></span>');var I=$('<span><span class="glyphicon glyphicon-chevron-right"></span></span>');if(typeof(K)==="object"){if("prev" in K){H.html(K.prev)}if("next" in K){I.html(K.next)}}var N=O.data("showPrevious");if(typeof(N)==="number"||N===false){N=q(O.data("showPrevious"),true)}var M=$('<div class="calendar-month-navigation"></div>');M.attr("id",O.attr("id")+"_nav-prev");M.data("navigation","prev");if(N!==false){prevMonth=(J-1);prevYear=L;if(prevMonth==-1){prevYear=(prevYear-1);prevMonth=11}M.data("to",{year:prevYear,month:(prevMonth+1)});M.append(H);if(typeof(O.data("actionNavFunction"))==="function"){M.click(O.data("actionNavFunction"))}M.click(function(Q){x(O,C,prevYear,prevMonth)})}var G=O.data("showNext");if(typeof(G)==="number"||G===false){G=q(O.data("showNext"),false)}var E=$('<div class="calendar-month-navigation"></div>');E.attr("id",O.attr("id")+"_nav-next");E.data("navigation","next");if(G!==false){nextMonth=(J+1);nextYear=L;if(nextMonth==12){nextYear=(nextYear+1);nextMonth=0}E.data("to",{year:nextYear,month:(nextMonth+1)});E.append(I);if(typeof(O.data("actionNavFunction"))==="function"){E.click(O.data("actionNavFunction"))}E.click(function(Q){x(O,C,nextYear,nextMonth)})}var P=O.data("monthLabels");var F=$("<th></th>").append(M);var z=$("<th></th>").append(E);var D=$("<span>"+P[J]+" "+L+"</span>");D.dblclick(function(){var Q=O.data("initDate");x(O,C,Q.getFullYear(),Q.getMonth())});var A=$('<th colspan="5"></th>');A.append(D);var B=$('<tr class="calendar-month-header"></tr>');B.append(F,A,z);C.append(B);return C}function e(C,E){if(C.data("showDays")===true){var z=C.data("weekStartsOn");var A=C.data("dowLabels");if(z===0){var D=$.extend([],A);var F=new Array(D.pop());A=F.concat(D)}var B=$('<tr class="calendar-dow-header"></tr>');$(A).each(function(G,H){B.append("<th>"+H+"</th>")});E.append(B)}return E}function r(H,G,J,O){var F=H.data("ajaxSettings");var I=u(J,O);var z=o(J,O);var E=i(J,O,1);var Q=i(J,O,z);var D=1;var C=H.data("weekStartsOn");if(C===0){if(Q==6){I++}if(E==6&&(Q==0||Q==1||Q==5)){I--}E++;if(E==7){E=0}}for(var B=0;B<I;B++){var A=$('<tr class="calendar-dow"></tr>');for(var L=0;L<7;L++){if(L<E||D>z){A.append("<td></td>")}else{var P=H.attr("id")+"_"+k(J,O,D);var N=P+"_day";var M=$('<div id="'+N+'" class="day" >'+D+"</div>");M.data("day",D);if(H.data("showToday")===true){if(y(J,O,D)){M.html('<span class="badge badge-today">'+D+"</span>")}}var K=$('<td id="'+P+'"></td>');K.append(M);K.data("date",k(J,O,D));K.data("hasEvent",false);if(typeof(H.data("actionFunction"))==="function"){K.addClass("dow-clickable");K.click(function(){H.data("selectedDate",$(this).data("date"))});K.click(H.data("actionFunction"))}A.append(K);D++}if(L==6){E=0}}G.append(A)}return G}function h(C,I,H,K){var J=$('<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>');var B=$('<h4 class="modal-title" id="'+C+'_modal_title">'+I+"</h4>");var L=$('<div class="modal-header"></div>');L.append(J);L.append(B);var G=$('<div class="modal-body" id="'+C+'_modal_body">'+H+"</div>");var F=$('<div class="modal-footer" id="'+C+'_modal_footer"></div>');if(typeof(K)!=="undefined"){var A=$("<div>"+K+"</div>");F.append(A)}var D=$('<div class="modal-content"></div>');D.append(L);D.append(G);D.append(F);var z=$('<div class="modal-dialog"></div>');z.append(D);var E=$('<div class="modal fade" id="'+C+'_modal" tabindex="-1" role="dialog" aria-labelledby="'+C+'_modal_title" aria-hidden="true"></div>');E.append(z);E.data("dateId",C);E.attr("dateId",C);return E}function s(B,A,E){var z=B.data("jsonData");var D=B.data("ajaxSettings");var C=$.Event("calendar.events.check",{year:A,month:E});B.trigger(C).data("events",false);if(false!==z){return n(B)}else{if(false!==D){return v(B,A,E)}}return true}function n(A){var z=A.data("jsonData");A.data("events",z);f(A,"json");return true}function v(A,z,D){var C=A.data("ajaxSettings");if(typeof(C)!="object"||typeof(C.url)=="undefined"){alert("Invalid calendar event settings");return false}var B={year:z,month:(D+1)};$.ajax({type:"GET",url:C.url,data:B,dataType:"json"}).done(function(E){var F=[];$.each(E,function(H,G){F.push(E[H])});A.data("events",F);f(A,"ajax")});return true}function f(C,B){var A=C.data("jsonData");var D=C.data("ajaxSettings");var z=C.data("events");if(z!==false){$(z).each(function(I,K){var E=C.attr("id")+"_"+K.date;var G=$("#"+E);var L=$("#"+E+"_day");if(!G.length){return}G.data("hasEvent",true).data("event",K);if(typeof(K.title)!=="undefined"){G.attr("title",K.title)}if(typeof(K.classname)==="undefined"){G.addClass("event")}else{G.addClass("event-styled");L.addClass(K.classname)}if(typeof(K.badge)!=="undefined"&&K.badge!==false){var F=(K.badge===true)?"":" badge-"+K.badge;var H=L.data("day");L.html('<span class="badge badge-event'+F+'">'+H+"</span>")}if(typeof(K.body)!=="undefined"){var J=false;if(B==="json"&&typeof(K.modal)!=="undefined"&&K.modal===true){J=true}else{if(B==="ajax"&&"modal" in D&&D.modal===true){J=true}}if(J===true){G.addClass("event-clickable");var M=h(E,K.title,K.body,K.footer);$("body").append(M);$("#"+E).click(function(){$("#"+E+"_modal").modal()})}}})}}function y(B,C,A){var D=new Date();var z=new Date(B,C,A);return(z.toDateString()==D.toDateString())}function k(A,B,z){d=(z<10)?"0"+z:z;m=B+1;m=(m<10)?"0"+m:m;return A+"-"+m+"-"+d}function i(B,C,A){var z=new Date(B,C,A,0,0,0,0);var D=z.getDay();if(D==0){D=6}else{D--}return D}function o(A,B){var z=28;while(w(A,B+1,z+1)){z++}return z}function u(B,D){var z=o(B,D);var F=i(B,D,1);var C=i(B,D,z);var E=z;var A=(F-C);if(A>0){E+=A}return Math.ceil(E/7)}function w(B,z,A){return z>0&&z<13&&B>0&&B<32768&&A>0&&A<=(new Date(B,z,0)).getDate()}function q(B,D){if(B===false){B=0}var C=j.data("currDate");var A=j.data("initDate");var z;z=(A.getFullYear()-C.getFullYear())*12;z-=C.getMonth()+1;z+=A.getMonth();if(D===true){if(z<(parseInt(B)-1)){return true}}else{if(z>=(0-parseInt(B))){return true}}return false}$.extend(p,{jsonEvents:function(z){if(z){j.data("jsonData",z)}return n(j)}})});return this};$.fn.zabuto_calendar_defaults=function(){var a=new Date();var c=a.getFullYear();var e=a.getMonth()+1;var b={language:false,year:c,month:e,show_previous:true,show_next:true,cell_border:false,today:false,show_days:true,weekstartson:1,nav_icon:false,data:false,ajax:false,legend:false,action:false,action_nav:false};return b};$.fn.zabuto_calendar_language=function(a){if(typeof(a)=="undefined"||a===false){a="en"}switch(a.toLowerCase()){case"de":return{month_labels:["Januar","Februar","März","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],dow_labels:["Mo","Di","Mi","Do","Fr","Sa","So"]};break;case"en":return{month_labels:["January","February","March","April","May","June","July","August","September","October","November","December"],dow_labels:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"]};break;case"ar":return{month_labels:["يناير","فبراير","مارس","أبريل","مايو","يونيو","يوليو","أغسطس","سبتمبر","أكتوبر","نوفمبر","ديسمبر"],dow_labels:["أثنين","ثلاثاء","اربعاء","خميس","جمعه","سبت","أحد"]};break;case"es":return{month_labels:["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],dow_labels:["Lu","Ma","Mi","Ju","Vi","Sá","Do"]};break;case"fr":return{month_labels:["Janvier","Février","Mars","Avril","Mai","Juin","Juillet","Août","Septembre","Octobre","Novembre","Décembre"],dow_labels:["Lun","Mar","Mer","Jeu","Ven","Sam","Dim"]};break;case"it":return{month_labels:["Gennaio","Febbraio","Marzo","Aprile","Maggio","Giugno","Luglio","Agosto","Settembre","Ottobre","Novembre","Dicembre"],dow_labels:["Lun","Mar","Mer","Gio","Ven","Sab","Dom"]};break;case"nl":return{month_labels:["Januari","Februari","Maart","April","Mei","Juni","Juli","Augustus","September","Oktober","November","December"],dow_labels:["Ma","Di","Wo","Do","Vr","Za","Zo"]};break;case"pt":return{month_labels:["Janeiro","Fevereiro","Marco","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],dow_labels:["S","T","Q","Q","S","S","D"]};break;case"ru":return{month_labels:["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"],dow_labels:["Пн","Вт","Ср","Чт","Пт","Сб","Вск"]};break;case"se":return{month_labels:["Januari","Februari","Mars","April","Maj","Juni","Juli","Augusti","September","Oktober","November","December"],dow_labels:["Mån","Tis","Ons","Tor","Fre","Lör","Sön"]};break;case"tr":return{month_labels:["Ocak","Şubat","Mart","Nisan","Mayıs","Haziran","Temmuz","Ağustos","Eylül","Ekim","Kasım","Aralık"],dow_labels:["Pts","Salı","Çar","Per","Cuma","Cts","Paz"]};break}};